Piecewise outputs are:
Step1, x, desired, predicted
Step1, 0.0, 3.4756274694207345, 3.4756274223327637
Step1, 0.05, 3.551991998236726, 3.5317225456237793
Step1, 0.1, 3.618773297389442, 3.587817668914795
Step1, 0.15000000000000002, 3.675376716157251, 3.6439127922058105
Step1, 0.2, 3.7212924182581846, 3.700007915496826
Step1, 0.25, 3.756102976650862, 3.756103038787842
Step1, 0.30000000000000004, 3.7794896496522017, 3.756103038787842
Step1, 0.35000000000000003, 3.7912372074247234, 3.7561028003692627
Step1, 0.4, 3.7912372074247234, 3.7561028003692627
Step1, 0.45, 3.7794896496522017, 3.756103038787842
Step1, 0.5, 3.756102976650862, 3.7561025619506836
Step1, 0.55, 3.721292418258184, 3.700007438659668
Step1, 0.6000000000000001, 3.6753767161572504, 3.6439123153686523
Step1, 0.65, 3.618773297389442, 3.587817430496216
Step1, 0.7000000000000001, 3.5519919982367254, 3.5317223072052
Step1, 0.75, 3.4756274694207345, 3.4756271839141846
Step1, 0.8, 3.390350419627351, 3.375627279281616
Step1, 0.8500000000000001, 3.2968978762957333, 3.2756271362304688
Step1, 0.9, 3.1960626598866178, 3.1756272315979004
Step1, 0.9500000000000001, 3.088682280089472, 3.075627326965332
Step1, 1.0, 2.9756274694207345, 2.9756274223327637
Learned outputs are:
Step2, x, desired, predicted
Step2, 0.0, 3.4756274694207345, 3.5485782623291016
Step2, 0.05, 3.551991998236726, 3.583049774169922
Step2, 0.1, 3.618773297389442, 3.617521286010742
Step2, 0.15000000000000002, 3.675376716157251, 3.6519930362701416
Step2, 0.2, 3.7212924182581846, 3.686464309692383
Step2, 0.25, 3.756102976650862, 3.7209360599517822
Step2, 0.30000000000000004, 3.7794896496522017, 3.7554078102111816
Step2, 0.35000000000000003, 3.7912372074247234, 3.7885594367980957
Step2, 0.4, 3.7912372074247234, 3.790342330932617
Step2, 0.45, 3.7794896496522017, 3.7921254634857178
Step2, 0.5, 3.756102976650862, 3.7669594287872314
Step2, 0.55, 3.721292418258184, 3.7404191493988037
Step2, 0.6000000000000001, 3.6753767161572504, 3.6840293407440186
Step2, 0.65, 3.618773297389442, 3.6031746864318848
Step2, 0.7000000000000001, 3.5519919982367254, 3.522320032119751
Step2, 0.75, 3.4756274694207345, 3.441465377807617
Step2, 0.8, 3.390350419627351, 3.3606109619140625
Step2, 0.8500000000000001, 3.2968978762957333, 3.2797563076019287
Step2, 0.9, 3.1960626598866178, 3.198901891708374
Step2, 0.9500000000000001, 3.088682280089472, 3.1180472373962402
Step2, 1.0, 2.9756274694207345, 3.0371928215026855
Learned parameters:
Layer 1 weights: Parameter containing:
tensor([[-0.6993],
        [-1.0490],
        [-0.2497],
        [ 0.1424],
        [ 1.2297],
        [ 0.6315],
        [-0.0090],
        [ 0.9225]], requires_grad=True)
Layer 1 bias: Parameter containing:
tensor([-0.4114,  0.3650,  0.8315, -0.4088, -0.7040,  0.1183,  1.5752, -0.4174],
       requires_grad=True)
Layer 3 weights: Parameter containing:
tensor([[-0.1510, -0.6232,  0.6511, -0.0629, -0.8834,  0.3325,  1.2979, -0.6141]],
       requires_grad=True)
Layer 3 bias: Parameter containing:
tensor([1.1508], requires_grad=True)
Step3, x, piece 0, piece 1, piece 2, piece 3, piece 4, piece 5, piece 6, piece 7
Step3, 0.0, 3.4756274223327637, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
Step3, 0.05, 3.5317225456237793, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
Step3, 0.1, 3.587817668914795, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
Step3, 0.15000000000000002, 3.6439127922058105, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
Step3, 0.2, 3.700007915496826, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
Step3, 0.25, 3.756103038787842, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
Step3, 0.30000000000000004, 3.8121981620788574, 0.0, 0.0, 0.0, -0.056095123291015625, 0.0, 0.0, 0.0
Step3, 0.35000000000000003, 3.868293046951294, 0.0, 0.0, 0.0, -0.11219018697738647, 0.0, 0.0, 0.0
Step3, 0.4, 3.9243881702423096, 0.0, 0.0, 0.0, -0.1682853102684021, 0.0, 0.0, 0.0
Step3, 0.45, 3.980483293533325, 0.0, 0.0, 0.0, -0.22438037395477295, 0.0, 0.0, 0.0
Step3, 0.5, 4.036578178405762, 0.0, 0.0, 0.0, -0.2804754972457886, 0.0, 0.0, 0.0
Step3, 0.55, 4.092673301696777, 0.0, -0.056095123291015625, 0.0, -0.3365706205368042, 0.0, 0.0, 0.0
Step3, 0.6000000000000001, 4.148768424987793, 0.0, -0.11219024658203125, 0.0, -0.3926657438278198, 0.0, 0.0, 0.0
Step3, 0.65, 4.204863548278809, 0.0, -0.16828525066375732, 0.0, -0.4487607479095459, 0.0, 0.0, 0.0
Step3, 0.7000000000000001, 4.260958671569824, 0.0, -0.22438037395477295, 0.0, -0.5048558712005615, 0.0, 0.0, 0.0
Step3, 0.75, 4.31705379486084, 0.0, -0.2804754972457886, 0.0, -0.5609509944915771, 0.0, 0.0, 0.0
Step3, 0.8, 4.3731489181518555, 0.0, -0.3365706205368042, -0.10000002384185791, -0.6170461177825928, 0.0, 0.056095123291015625, 0.0
Step3, 0.8500000000000001, 4.429244041442871, 0.0, -0.3926657438278198, -0.20000004768371582, -0.6731412410736084, 0.0, 0.11219024658203125, 0.0
Step3, 0.9, 4.485339164733887, 0.0, -0.4487607479095459, -0.2999999523162842, -0.7292362451553345, 0.0, 0.16828525066375732, 0.0
Step3, 0.9500000000000001, 4.541434288024902, 0.0, -0.5048558712005615, -0.3999999761581421, -0.7853313684463501, 0.0, 0.22438037395477295, 0.0
Step3, 1.0, 4.597529411315918, 0.0, -0.5609509944915771, -0.5, -0.8414264917373657, 0.0, 0.2804754972457886, 0.0
Step4, x, piece 0, piece 1, piece 2, piece 3, piece 4, piece 5, piece 6, piece 7
Step4, 0.0, 1.1507892608642578, 0.9232887029647827, 1.6921839714050293, 1.1507892608642578, 1.1507892608642578, 1.1901384592056274, 3.1953346729278564, 1.1507892608642578
Step4, 0.05, 1.1507892608642578, 0.9559773802757263, 1.684053897857666, 1.1507892608642578, 1.1507892608642578, 1.2006384134292603, 3.1947476863861084, 1.1507892608642578
Step4, 0.1, 1.1507892608642578, 0.9886660575866699, 1.6759238243103027, 1.1507892608642578, 1.1507892608642578, 1.2111384868621826, 3.1941606998443604, 1.1507892608642578
Step4, 0.15000000000000002, 1.1507892608642578, 1.0213546752929688, 1.6677937507629395, 1.1507892608642578, 1.1507892608642578, 1.2216384410858154, 3.1935739517211914, 1.1507892608642578
Step4, 0.2, 1.1507892608642578, 1.0540432929992676, 1.6596636772155762, 1.1507892608642578, 1.1507892608642578, 1.2321383953094482, 3.1929867267608643, 1.1507892608642578
Step4, 0.25, 1.1507892608642578, 1.086732029914856, 1.651533603668213, 1.1507892608642578, 1.1507892608642578, 1.2426384687423706, 3.1923999786376953, 1.1507892608642578
Step4, 0.30000000000000004, 1.1507892608642578, 1.1194206476211548, 1.6434035301208496, 1.1507892608642578, 1.1507892608642578, 1.2531384229660034, 3.1918129920959473, 1.1507892608642578
Step4, 0.35000000000000003, 1.1507892608642578, 1.1507892608642578, 1.6352734565734863, 1.1507892608642578, 1.1507892608642578, 1.2636383771896362, 3.191226005554199, 1.1507892608642578
Step4, 0.4, 1.1507892608642578, 1.1507892608642578, 1.627143383026123, 1.1507892608642578, 1.1507892608642578, 1.2741384506225586, 3.190639019012451, 1.1507892608642578
Step4, 0.45, 1.1507892608642578, 1.1507892608642578, 1.6190133094787598, 1.1507892608642578, 1.1507892608642578, 1.2846384048461914, 3.1900522708892822, 1.1507892608642578
Step4, 0.5, 1.1507892608642578, 1.1507892608642578, 1.6108832359313965, 1.1507892608642578, 1.1507892608642578, 1.2951383590698242, 3.189465284347534, 1.12384033203125
Step4, 0.55, 1.1507892608642578, 1.1507892608642578, 1.6027531623840332, 1.1507892608642578, 1.1507892608642578, 1.305638313293457, 3.188878297805786, 1.0955170392990112
Step4, 0.6000000000000001, 1.1507892608642578, 1.1507892608642578, 1.59462308883667, 1.1507892608642578, 1.1209396123886108, 1.3161383867263794, 3.188291311264038, 1.067193865776062
Step4, 0.65, 1.1507892608642578, 1.1507892608642578, 1.5864930152893066, 1.1507892608642578, 1.0666253566741943, 1.3266383409500122, 3.18770432472229, 1.0388705730438232
Step4, 0.7000000000000001, 1.1507892608642578, 1.1507892608642578, 1.5783629417419434, 1.1507892608642578, 1.0123111009597778, 1.337138295173645, 3.187117576599121, 1.0105472803115845
Step4, 0.75, 1.1507892608642578, 1.1507892608642578, 1.57023286819458, 1.1507892608642578, 0.9579968452453613, 1.3476383686065674, 3.186530351638794, 0.9822241067886353
Step4, 0.8, 1.1507892608642578, 1.1507892608642578, 1.5621027946472168, 1.1507892608642578, 0.9036824703216553, 1.3581383228302002, 3.185943603515625, 0.9539008140563965
Step4, 0.8500000000000001, 1.1507892608642578, 1.1507892608642578, 1.5539727210998535, 1.1507892608642578, 0.8493682146072388, 1.368638277053833, 3.185356616973877, 0.9255775213241577
Step4, 0.9, 1.1507892608642578, 1.1507892608642578, 1.5458426475524902, 1.1507892608642578, 0.7950539588928223, 1.3791383504867554, 3.184769630432129, 0.8972543478012085
Step4, 0.9500000000000001, 1.1507892608642578, 1.1507892608642578, 1.537712574005127, 1.1507892608642578, 0.740739643573761, 1.3896383047103882, 3.18418288230896, 0.8689310550689697
Step4, 1.0, 1.1507892608642578, 1.1507892608642578, 1.5295825004577637, 1.1507892608642578, 0.6864253282546997, 1.400138258934021, 3.183595895767212, 0.840607762336731
